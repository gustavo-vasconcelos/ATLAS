(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1397a94e"],{"32e6":function(t,e,s){"use strict";s("dcb3")},"535f":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.loading.page?s("div",{staticClass:"text-center"},[s("p",{staticClass:"mb-5"},[t._v(" ")]),s("b-spinner",{staticClass:"mt-5",staticStyle:{width:"8rem",height:"8rem"},attrs:{variant:"atlas",label:"A carregar..."}})],1):s("div",[s("div",[s("TitleAtlas",[s("b",{staticClass:"text-atlas2"},[t._v("["+t._s(t.event.category)+"]")]),t._v("\n\t\t\t\t"+t._s(t.event.name)+"\n\t\t\t\t"),t.btnConditions()?[s("button",{staticClass:"btn btn-atlas2",on:{click:function(e){t.modalEdit=!0}}},[s("i",{staticClass:"fa fa-edit",attrs:{"aria-hidden":"true"}})]),s("button",{staticClass:"btn btn-danger ml-2",on:{click:function(e){return t.btnRemoveClicked()}}},[s("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]:t._e()],2),s("div",{staticClass:"row"},[s("div",{staticClass:"ml-auto mr-auto mb-2",class:"Vertical"===t.event.picture.poster.orientation?"col-lg-4 col-md-5 col-6":"col-lg-6 col-12"},[s("img",{staticClass:"img-fluid img-thumbnail",attrs:{src:t.event.picture.poster.url}})]),s("div",{class:"Vertical"===t.event.picture.poster.orientation?"col-lg-8 col-12":"col-12"},[s("div",[s("h4",[t._v("Descrição:")]),t._v("\n\t\t\t\t\t\t"+t._s(t.event.description)+"\n\t\t\t\t\t")]),s("hr",{staticClass:"bg-atlas1"}),s("div",[s("div",[s("i",{staticClass:"fa fa-map-marker-alt text-atlas1",attrs:{"aria-hidden":"true"}}),s("router-link",{staticClass:"text-atlas2 ml-1",attrs:{to:{name:"events",query:{sala:t.event.classroom}}}},[t._v(t._s(t.event.classroom))])],1),s("div",[s("i",{staticClass:"fa fa-calendar-alt text-atlas1 mr-1",attrs:{"aria-hidden":"true"}}),t.event.dateStart===t.event.dateEnd?s("span",[t._v(t._s(t.$moment(t.event.dateStart.substr(0,10)).format("dddd[,] LL")))]):s("span",[t._v(t._s(t.$moment(t.event.dateStart.substr(0,10)).format("dddd[,] LL"))+" - "+t._s(t.$moment(t.event.dateEnd.substr(0,10)).format("dddd[,] LL")))])]),s("div",[s("i",{staticClass:"fa fa-clock text-atlas1",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t\t\t\t"+t._s(t.event.hourStart)+" - "+t._s(t.event.hourEnd)+"\n\t\t\t\t\t\t")]),s("div",[s("router-link",{staticClass:"text-atlas2",attrs:{to:{name:"profile",params:{username:t.event.author.username}}}},[s("i",{staticClass:"fa fa-microphone-alt text-atlas1",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t\t\t\t\t@"+t._s(t.event.author.username)+"\n\t\t\t\t\t\t\t")])],1),s("div",[s("i",{staticClass:"fa fa-users text-atlas1 mr-1",attrs:{"aria-hidden":"true"}}),t.event.enrollments.length?s("a",{staticClass:"text-atlas2",attrs:{href:""},on:{click:function(e){e.preventDefault(),t.modalEnrollments=!0}}},[t._v(t._s(t.event.enrollments.length)+" "+t._s(t.$moment(t.event.dateEnd.substr(0,10)+" "+t.event.hourEnd).isBefore(t.$moment())?1===t.event.enrollments.length?"foi":"foram":1===t.event.enrollments.length?"vai":"vão"))]):[t._v(t._s(t.$moment(t.event.dateEnd.substr(0,10)+" "+t.event.hourEnd).isBefore(t.$moment())?"Sem inscrições":"Ainda sem inscrições"))]],2),s("div",[s("i",{staticClass:"fa fa-tags text-atlas1",attrs:{"aria-hidden":"true"}}),t._l(t.event.tags,(function(e){return s("router-link",{key:"tag_"+e._id,staticClass:"text-atlas2",attrs:{to:{name:"events",query:{tags:e.name}}}},[t._v("#"+t._s(e.name))])}))],2),s("div",[s("i",{staticClass:"fa fa-graduation-cap text-atlas1 mr-1",attrs:{"aria-hidden":"true"}}),t._l(t.event.courses,(function(e,n){return s("span",{key:"course_"+e._id},[s("router-link",{staticClass:"text-atlas2",attrs:{to:{name:"events",query:{curso:e.abbreviation}}}},[t._v(t._s(e.name))]),n<t.event.courses.length-1?s("span",[t._v(" / ")]):t._e()],1)}))],2),t.event.paid?s("div",[s("i",{staticClass:"fa fa-sign-in-alt text-atlas1",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t\t\t\tPreço de inscrição "+t._s(t.event.paymentPrice)+" €\n\t\t\t\t\t\t")]):t._e()]),t.$moment(t.event.dateEnd.substr(0,10)).isSameOrAfter(t.$moment().format("YYYY-MM-DD"))&&3!==t.getLoggedUser.profileId?[s("hr",{staticClass:"bg-atlas1"}),s("button",{staticClass:"btn btn-atlas2 px-5 col-12 mr-auto ml-auto mt-2",staticStyle:{"border-radius":"2em"},on:{click:function(e){return t.btnEnrollmentClicked()}}},[t.loading.enrollment?[s("b-spinner",{attrs:{variant:"atlas",small:"",label:"A carregar..."}})]:[s("i",{staticClass:"fa text-teca4",class:t.event.enrollments.some((function(e){return e.user._id===t.getLoggedUser._id}))?"fa-sign-out-alt":"fa-sign-in-alt"}),t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.event.enrollments.some((function(e){return e.user._id===t.getLoggedUser._id}))?"Desinscrever-me":"Inscrever-me")+"\n\t\t\t\t\t\t\t")]],2)]:t._e()],2)])],1),t.event.picture.gallery.length?s("div",{staticClass:"mt-5"},[s("TitleAtlas",[t._v("Galeria")]),s("b-carousel",{attrs:{id:"picturesCarousel",controls:"",interval:4e3},model:{value:t.slide,callback:function(e){t.slide=e},expression:"slide"}},t._l(t.event.picture.gallery,(function(e){return s("b-carousel-slide",{key:t.event._id+"_picture_"+e,attrs:{"img-src":e}})})),1)],1):t._e(),s("div",{staticClass:"mt-5"},[s("TitleAtlas",[t._v("\n\t\t\t\tDiscussões\n\t\t\t\t"),s("button",{staticClass:"btn btn-atlas2",on:{click:function(e){return t.btnCreateDiscussionClicked()}}},[s("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])]),t.event.discussions.length?[t._l(t.getDiscussionsSelectedPage,(function(t){return s("EventDiscussion",{key:t.id,staticClass:"mb-1",attrs:{discussion:t}})})),t.event.discussions.length>t.discussionsPerPage?s("div",{staticClass:"mt-3"},[s("vs-pagination",{attrs:{total:t.totalPages},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1):t._e()]:s("p",[t._v("Este evento ainda não possui nenhuma discussão.")])],2),s("div",{staticClass:"mt-5"},[s("TitleAtlas",[t._v("Eventos relacionados")]),t.windowWidth>=768?t._l(t.related,(function(t){return s("EventListItem",{key:"relatedEvent_"+t._id,staticClass:"mb-1",attrs:{event:t}})})):t._l(t.related,(function(t){return s("EventCard",{key:"relatedEvent_"+t._id,staticClass:"mb-1",attrs:{event:t}})}))],2),s("b-modal",{attrs:{title:"Utilizadores inscritos - "+t.event.enrollments.length,"header-bg-variant":"atlas1","header-text-variant":"white",centered:!0,"hide-footer":!0},on:{hidden:function(e){t.enrollmentsFilter=""}},model:{value:t.modalEnrollments,callback:function(e){t.modalEnrollments=e},expression:"modalEnrollments"}},[s("b-form-input",{attrs:{id:"enrollmentsFilter",placeholder:"Filtrar por utilizador...",type:"text"},model:{value:t.enrollmentsFilter,callback:function(e){t.enrollmentsFilter=e},expression:"enrollmentsFilter"}}),s("hr"),t._l(t.getFilteredEnrollments,(function(e,n){return s("div",{key:"enrollment_"+e.user._id},[s("div",{staticClass:"text-center"},[s("router-link",{staticClass:"text-atlas2 ml-2",attrs:{to:{name:"profile",params:{username:e.user.username}}}},[s("img",{staticClass:"rounded-circle img-thumbnail img-fluid",staticStyle:{height:"100px",width:"100px"},attrs:{src:e.user.picture,alt:""}})]),t.windowWidth<520?s("br"):t._e(),s("router-link",{staticClass:"text-atlas2 ml-2",attrs:{to:{name:"profile",params:{username:e.user.username}}}},[t._v("@"+t._s(e.user.username))]),t._v("\n\t\t\t\t\t/ "+t._s(t.$moment(e.createdAt).format("LLL"))+"\n\t\t\t\t")],1),t.btnConditions()?[s("div",{staticClass:"row mt-2"},[t.event.paid?s("button",{staticClass:"btn btn-atlas2 col-12 col-sm-6 ml-auto",on:{click:function(s){return t.btnPaymentClicked(e)}}},[e.loading?[s("b-spinner",{attrs:{variant:"atlas",small:"",label:"A carregar..."}})]:[s("i",{staticClass:"fa",class:e.paid?"fa-times":"fa-check",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.paid?"Devolver pagamento":"Validar pagamento")+"\n\t\t\t\t\t\t\t")]],2):t._e(),s("button",{staticClass:"btn btn-danger",class:t.event.paid?"col-12 col-sm-6 mr-auto":"col-12",attrs:{disabled:e.paid},on:{click:function(s){return t.btnRemoveEnrollmentClicked(e,n)}}},[s("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}}),t._v(" Remover inscrição\n\t\t\t\t\t\t")])])]:t._e(),n!==t.event.enrollments.length-1?s("hr"):t._e()],2)}))],2),s("b-modal",{attrs:{title:"Adicionar discussão","header-bg-variant":"atlas1","header-text-variant":"white",centered:!0,"hide-footer":!0},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[s("FormDiscussion",{attrs:{eventId:this.event.id}})],1),s("b-modal",{attrs:{title:"Editar evento","header-bg-variant":"atlas1","header-text-variant":"white",centered:!0,"hide-footer":!0},model:{value:t.modalEdit,callback:function(e){t.modalEdit=e},expression:"modalEdit"}},[s("FormEvent",{attrs:{edit:t.event}})],1)],1)])},r=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("20d6"),s("a481"),s("96cf"),s("1da1")),i=(s("6762"),s("2fdb"),s("55dd"),s("ade3")),o=(s("7f7f"),s("fc6e")),c=s("7ec7"),l=s.n(c),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-atlas2 p-2 text-white"},[s("div",{staticClass:"row px-3"},[s("div",{staticClass:"mr-3"},[s("i",{staticClass:"fa fa-arrow-up text-atlas1 upvoteButton",attrs:{"aria-hidden":"true"},on:{click:t.buttonUpvoteClicked}}),s("br"),t._v("\n\t\t\t"+t._s(t.discussion.upvotes-t.discussion.downvotes)+"\n\t\t\t"),s("br"),s("i",{staticClass:"fa fa-arrow-down text-atlas1 downvoteButton",attrs:{"aria-hidden":"true"},on:{click:t.buttonDownvoteClicked}})]),s("div",[s("div",[s("router-link",{staticClass:"text-white",attrs:{to:{name:"eventDiscussion",params:{id:t.$route.params.id,discussionId:t.discussion._id}}}},[s("b",{staticClass:"text-atlas3",class:"Anúncio"===t.discussion.category?"bg-atlas1 p-1 rounded":""},[t._v("["+t._s(t.discussion.category)+"]")]),t._v("\n\t\t\t\t\t"+t._s(t.discussion.title)+"\n\t\t\t\t")])],1),s("div",{staticClass:"row mt-4"},[s("div",{staticClass:"ml-3"},[s("router-link",{staticClass:"text-white",attrs:{to:{name:"profile",params:{username:t.discussion.author.username}}}},[s("i",{staticClass:"fa fa-user text-atlas1",attrs:{"aria-hidden":"true"}}),s("small",[t._v("@"+t._s(t.discussion.author.username))])])],1),s("div",{staticClass:"ml-3"},[s("i",{staticClass:"fa fa-comments text-atlas1",attrs:{"aria-hidden":"true"}}),s("small",[t._v(" "+t._s(t.discussion.answers)+" "+t._s(1===t.discussion.answers?"resposta":"respostas"))])]),s("div",{staticClass:"ml-3"},[s("i",{staticClass:"fa fa-calendar-alt text-atlas1",attrs:{"aria-hidden":"true"}}),s("small",[t._v(" "+t._s(t.$moment(t.discussion.createdAt).format("LL")))])]),s("div",{staticClass:"ml-3"},[s("i",{staticClass:"fa fa-clock text-atlas1",attrs:{"aria-hidden":"true"}}),s("small",[t._v(" "+t._s(t.$moment(t.discussion.createdAt).format("HH:mm")))])])])])])])},d=[],m=s("2f62");function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function v(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){Object(i["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var p={props:["discussion"],data:function(){return{mouseOverUpvote:!1}},methods:{buttonUpvoteClicked:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.getLoggedUser.username){t.next=17;break}if(this.userAlreadyVoted){t.next=14;break}return t.prev=2,t.next=5,this.$http.post("/events/ids/".concat(this.$route.params.id,"/discussions/").concat(this.discussion._id,"/votes"),{type:"upvote"});case 5:e=t.sent,200===e.status&&(this.discussion.upvotes++,this.discussion.usersVoted.push(this.getLoggedUser._id)),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),void 0!==t.t0.response.message.pt&&this.$snotify.error(t.t0.response.message.pt,"",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 12:t.next=15;break;case 14:this.$snotify.error("Já votou nesta discussão","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 15:t.next=19;break;case 17:this.$store.commit("REDIRECT_AFTER_LOGIN",this.$route.path),this.$router.push({name:"login"});case 19:case"end":return t.stop()}}),t,this,[[2,9]])})));function e(){return t.apply(this,arguments)}return e}(),buttonDownvoteClicked:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.getLoggedUser.username){t.next=17;break}if(this.userAlreadyVoted){t.next=14;break}return t.prev=2,t.next=5,this.$http.post("/events/ids/".concat(this.$route.params.id,"/discussions/").concat(this.discussion._id,"/votes"),{type:"downvote"});case 5:e=t.sent,200===e.status&&(this.discussion.downvotes++,this.discussion.usersVoted.push(this.getLoggedUser._id)),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),void 0!==t.t0.response.message.pt&&this.$snotify.error(t.t0.response.message.pt,"",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 12:t.next=15;break;case 14:this.$snotify.error("Já votou nessa discussão","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 15:t.next=19;break;case 17:this.$store.commit("REDIRECT_AFTER_LOGIN",this.$route.path),this.$router.push({name:"login"});case 19:case"end":return t.stop()}}),t,this,[[2,9]])})));function e(){return t.apply(this,arguments)}return e}()},computed:v(v({},Object(m["c"])(["getLoggedUser"])),{},{userAlreadyVoted:function(){var t=this;return this.discussion.usersVoted.some((function(e){return e===t.getLoggedUser._id}))}})},g=p,f=(s("32e6"),s("2877")),b=Object(f["a"])(g,u,d,!1,null,null,null),x=b.exports,_=s("a09f"),y=s("9f23"),C=s("d85a"),w=s("a69d");function k(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function O(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?k(Object(s),!0).forEach((function(e){Object(i["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):k(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var E={name:"EventInfoView",components:{TitleAtlas:o["a"],Carousel:l.a,EventDiscussion:x,FormDiscussion:_["a"],FormEvent:y["a"],EventListItem:C["a"],EventCard:w["a"]},watch:{$route:function(){this.loadPage()}},beforeRouteUpdate:function(t,e,s){"eventsInfo"===t.name&&"sim"===t.query.inscrever&&this.enroll(),s()},created:function(){var t=this;this.loadPage(),this.$store.subscribe((function(e){if("EDITED_EVENT"===e.type&&(t.modal=!1,t.loadPage()),"ADDED_DISCUSSION"===e.type){t.modal=!1;var s=e.payload,n=s.createdAt,r=s.usersVoted,a=s._id,i=s.category,o=s.title;t.event.discussions.push({createdAt:n,usersVoted:r,_id:a,category:i,title:o,upvotes:0,downvotes:0,answers:0,author:{_id:t.getLoggedUser._id,username:t.getLoggedUser.username,picture:t.getLoggedUser.picture}})}})),"eventsInfo"===this.$route.name&&"sim"===this.$route.query.inscrever&&(this.$moment(this.event.dateEnd.substr(0,10)+" "+this.event.hourEnd).isSameOrAfter(this.$moment().format("YYYY-MM-DD HH:mm"))?this.event.enrollments.some((function(e){return e.userId===t.getLoggedUserId}))?this.$vs.dialog({type:"confirm",color:"primary",title:"Já se encontra inscrito",acceptText:"Entendido",cancelText:"",text:"Já efetuou inscrição no evento ".concat(this.event.name,".")}):this.enroll():this.$vs.dialog({type:"confirm",color:"danger",title:"Inscrições fechadas",acceptText:"Entendido",cancelText:"",text:"Este evento já ocorreu, portanto tem as inscrições fechadas."})),window.addEventListener("resize",this.handleResize),this.handleResize()},data:function(){return{event:[],related:[],modalEdit:!1,slide:0,modalEnrollments:!1,enrollmentsFilter:"",modal:!1,currentPage:1,discussionsPerPage:5,windowWidth:0,loading:{page:!1,enrollment:!1}}},computed:O(O({},Object(m["c"])(["getEventById","getLoggedUser"])),{},{totalPages:function(){return this.event.discussions.length<=this.discussionsPerPage?1:Math.floor(this.event.discussions.length/this.discussionsPerPage)+1},getDiscussionsByPopularity:function(){return this.event.discussions.sort((function(t,e){return t.upvotes-t.downvotes<e.upvotes-e.downvotes?1:t.upvotes-t.downvotes>e.upvotes-e.downvotes?-1:0}))},getDiscussionsSelectedPage:function(){return this.event.discussions.sort((function(t,e){return t.upvotes-t.downvotes<e.upvotes-e.downvotes?1:t.upvotes-t.downvotes>e.upvotes-e.downvotes?-1:0})),this.event.discussions.length>this.discussionsPerPage?this.event.discussions.slice((this.currentPage-1)*this.discussionsPerPage,this.discussionsPerPage*this.currentPage):this.event.discussions},getFilteredEnrollments:function(){var t=this;return this.enrollmentsFilter?this.event.enrollments.filter((function(e){return e.user.username.toLowerCase().includes(t.enrollmentsFilter.toLowerCase())})):this.event.enrollments}}),methods:{loadPage:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$route.params.id,this.loading.page=!0,t.prev=2,t.next=5,this.$http.get("/events/ids/".concat(e));case 5:s=t.sent,200===s.status&&(this.event=s.data.content.event,this.related=s.data.content.related,this.loading.page=!1),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),console.log(t.t0);case 12:case"end":return t.stop()}}),t,this,[[2,9]])})));function e(){return t.apply(this,arguments)}return e}(),handleResize:function(){this.windowWidth=window.innerWidth},btnCreateDiscussionClicked:function(){this.getLoggedUser.username?this.modal=!0:(this.$store.commit("REDIRECT_AFTER_LOGIN",this.$route.path),this.$router.push({name:"login"}))},btnConditions:function(){return!(!this.getLoggedUser.username||this.getLoggedUser._id!==this.event.author._id&&3!==this.getLoggedUser.profileId)},btnRemoveClicked:function(){var t=this;this.$vs.dialog({type:"confirm",color:"danger",title:"Remover evento?",acceptText:"Remover",cancelText:"Cancelar",text:"Este evento e todos os dados a este associado serão removidos para sempre.",accept:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$http.delete("/events/".concat(t.event._id));case 3:e.sent,t.$snotify.success("Evento removido","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0}),t.$router.replace({name:"events"}),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$snotify.error("Erro ao remover evento","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));function s(){return e.apply(this,arguments)}return s}()})},btnEnrollmentClicked:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,s,n,r,a,i,o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.getLoggedUser.username){t.next=5;break}this.$store.commit("REDIRECT_AFTER_LOGIN",this.$route.path),this.$router.push({name:"login"}),t.next=36;break;case 5:if(this.event.enrollments.some((function(t){return t.user._id===o.getLoggedUser._id}))){t.next=22;break}return t.prev=6,this.loading.enrollment=!0,t.next=10,this.$http.post("/events/ids/".concat(this.event._id,"/enrollments"));case 10:e=t.sent,s=e.data.content.enrollment,n=s._id,r=s.createdAt,a=s.paid,this.event.enrollments.push({_id:n,createdAt:r,paid:a,user:{_id:this.getLoggedUser._id,picture:this.getLoggedUser.picture,username:this.getLoggedUser.username}}),this.$vs.dialog({type:"confirm",color:"primary",title:"Inscrição em ".concat(this.event.name),acceptText:"Entendido",cancelText:"",text:e.data.message.pt}),this.loading.enrollment=!1,t.next=20;break;case 18:t.prev=18,t.t0=t["catch"](6);case 20:t.next=36;break;case 22:return t.prev=22,this.loading.enrollment=!0,t.next=26,this.$http.delete("/events/ids/".concat(this.event._id,"/enrollments"));case 26:t.sent,this.loading.enrollment=!1,i=this.event.enrollments.findIndex((function(t){return t.user.username===o.getLoggedUser.username})),this.event.enrollments.splice(i,1),this.$vs.dialog({type:"confirm",color:"primary",title:"Inscrição removida",acceptText:"Entendido",cancelText:"",text:"A sua inscrição no evento ".concat(this.event.name," foi removida com sucesso.")}),t.next=36;break;case 33:t.prev=33,t.t1=t["catch"](22),console.log(t.t1);case 36:case"end":return t.stop()}}),t,this,[[6,18],[22,33]])})));function e(){return t.apply(this,arguments)}return e}(),assignMedals:function(){this.$store.dispatch("assignMedals",{userId:this.getLoggedUserId,type:"EVENT"});var t=this.getUserById(this.getLoggedUserId).medals,e=t.splice(t.length,1);console.log(e)},historyUpdate:function(t){"ADD"===t&&this.$store.dispatch("historyUpdate",{type:"ADD",userId:this.getLoggedUserId,eventId:this.event.id}),"REMOVE"===t&&this.$store.dispatch("historyUpdate",{type:"REMOVE",userId:this.getLoggedUserId,eventId:this.event.id})},btnPaymentClicked:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,this.$http.post("/events/ids/".concat(this.event._id,"/enrollments/").concat(e.user._id,"/payments"));case 4:s=t.sent,s.data.success&&(e.paid=s.data.content.enrollment.paid,this.$snotify.success("Pagamento alterado com sucesso","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0})),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0),this.$snotify.error("Erro ao alterar pagamento","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 12:e.loading=!1;case 13:case"end":return t.stop()}}),t,this,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}(),btnRemoveEnrollmentClicked:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,s){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$http.delete("/events/ids/".concat(this.event._id,"/enrollments/").concat(e.user._id));case 3:n=t.sent,n.data.success&&(this.event.enrollments.splice(s,1),this.$snotify.success("Inscrição removida","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0})),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$snotify.error("Erro ao remover inscrição","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(e,s){return t.apply(this,arguments)}return e}()}},$=E,P=(s("ad08"),Object(f["a"])($,n,r,!1,null,null,null));e["default"]=P.exports},a09f:function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-form",{on:{submit:function(e){e.preventDefault(),t.edit?t.editDiscussion():t.createDiscussion()}}},[s("b-form-group",{attrs:{label:"Título","label-for":"name",state:t.titleState,"invalid-feedback":t.titleInvalidFeedback}},[s("b-form-input",{attrs:{id:"name",type:"text",maxlength:"50",state:t.titleState},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),s("b-form-group",{attrs:{label:"Categoria"}},[s("b-form-radio-group",{attrs:{buttons:"","button-variant":"outline-atlas2",options:t.categories,name:"categories"},model:{value:t.selectedCategory,callback:function(e){t.selectedCategory=e},expression:"selectedCategory"}})],1),s("b-form-group",{attrs:{label:"Texto","label-for":"text",state:t.textState,"invalid-feedback":t.textInvalidFeedback}},[s("b-form-textarea",{attrs:{id:"text",rows:3,"max-rows":6,state:t.textState},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),s("button",{staticClass:"btn btn-atlas1 col-12",attrs:{type:"submit"}},[t.loading?[s("b-spinner",{attrs:{variant:"atlas",small:"",label:"A carregar..."}})]:[t._v(t._s(t.edit?"Editar discussão":"Criar discussão"))]],2)],1)},r=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("ade3")),i=(s("96cf"),s("1da1")),o=s("2f62");function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function l(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var u={props:["eventId","edit"],created:function(){this.edit&&(this.title=this.edit.title,this.selectedCategory=this.edit.category,this.text=this.edit.content),-1!==this.getLoggedUserId&&(this.getLoggedUserId!==this.getEventById(this.eventId).authorId&&3!==this.getUserById(this.getLoggedUserId).profileId||this.categories.push("Anúncio"))},data:function(){return{attemptSubmit:!1,title:"",categories:["Dúvida","Sugestão"],selectedCategory:"Dúvida",text:"",loading:!1}},methods:{createDiscussion:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.attemptSubmit=!0,!this.titleState||!this.textState){t.next=17;break}return t.prev=2,this.loading=!0,t.next=6,this.$http.post("/events/ids/".concat(this.$route.params.id,"/discussions"),{category:this.selectedCategory,title:this.title,content:this.text});case 6:e=t.sent,this.$store.commit("ADDED_DISCUSSION",e.data.content.discussion),this.loading=!1,this.$snotify.success("Discussão criada","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0}),this.resetFormCreateDiscussion(),t.next=15;break;case 13:t.prev=13,t.t0=t["catch"](2);case 15:t.next=18;break;case 17:this.$snotify.error("Preencha todos os campos corretamente","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 18:case"end":return t.stop()}}),t,this,[[2,13]])})));function e(){return t.apply(this,arguments)}return e}(),editDiscussion:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.attemptSubmit=!0,!this.titleState||!this.textState){t.next=17;break}return t.prev=2,this.loading=!0,t.next=6,this.$http.put("/events/ids/".concat(this.$route.params.id,"/discussions/").concat(this.edit._id),{category:this.selectedCategory,title:this.title,content:this.text});case 6:e=t.sent,this.$store.commit("EDITED_DISCUSSION",e.data.content.discussion),this.loading=!1,this.$snotify.success("Discussão editada","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0}),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),console.log(t.t0);case 15:t.next=18;break;case 17:this.$snotify.error("Preencha todos os campos corretamente","",{timeout:2e3,showProgressBar:!1,closeOnClick:!0,pauseOnHover:!0});case 18:case"end":return t.stop()}}),t,this,[[2,12]])})));function e(){return t.apply(this,arguments)}return e}(),resetFormCreateDiscussion:function(){this.attemptSubmit=!1,this.title="",this.selectedCategory="Dúvida",this.text=""}},computed:l(l({},Object(o["c"])(["getLastDiscussionIdByEventId","getLoggedUserId","getEventById","getUserById"])),{},{titleState:function(){return this.title||this.attemptSubmit?!(!this.title&&this.attemptSubmit):null},titleInvalidFeedback:function(){return!this.title&&this.attemptSubmit?"Introduza o título":null},textState:function(){return this.text||this.attemptSubmit?!(!this.text&&this.attemptSubmit):null},textInvalidFeedback:function(){return!this.text&&this.attemptSubmit?"Introduza o texto":null}})},d=u,m=s("2877"),h=Object(m["a"])(d,n,r,!1,null,null,null);e["a"]=h.exports},a481:function(t,e,s){"use strict";var n=s("cb7c"),r=s("4bf8"),a=s("9def"),i=s("4588"),o=s("0390"),c=s("5f1b"),l=Math.max,u=Math.min,d=Math.floor,m=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g,v=function(t){return void 0===t?t:String(t)};s("214f")("replace",2,(function(t,e,s,p){return[function(n,r){var a=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,a,r):s.call(String(a),n,r)},function(t,e){var r=p(s,t,this,e);if(r.done)return r.value;var d=n(t),m=String(this),h="function"===typeof e;h||(e=String(e));var f=d.global;if(f){var b=d.unicode;d.lastIndex=0}var x=[];while(1){var _=c(d,m);if(null===_)break;if(x.push(_),!f)break;var y=String(_[0]);""===y&&(d.lastIndex=o(m,a(d.lastIndex),b))}for(var C="",w=0,k=0;k<x.length;k++){_=x[k];for(var O=String(_[0]),E=l(u(i(_.index),m.length),0),$=[],P=1;P<_.length;P++)$.push(v(_[P]));var D=_.groups;if(h){var I=[O].concat($,E,m);void 0!==D&&I.push(D);var S=String(e.apply(void 0,I))}else S=g(O,m,E,$,D,e);E>=w&&(C+=m.slice(w,E)+S,w=E+O.length)}return C+m.slice(w)}];function g(t,e,n,a,i,o){var c=n+t.length,l=a.length,u=h;return void 0!==i&&(i=r(i),u=m),s.call(o,u,(function(s,r){var o;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(c);case"<":o=i[r.slice(1,-1)];break;default:var u=+r;if(0===u)return s;if(u>l){var m=d(u/10);return 0===m?s:m<=l?void 0===a[m-1]?r.charAt(1):a[m-1]+r.charAt(1):s}o=a[u-1]}return void 0===o?"":o}))}}))},ad08:function(t,e,s){"use strict";s("b083")},b083:function(t,e,s){},dcb3:function(t,e,s){}}]);